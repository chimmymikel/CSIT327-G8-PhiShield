{% extends 'phishield/base.html' %}

{% block title %}Register - PhiShield{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="content-card mt-5 shadow-lg rounded-4 p-4 fade-in-card {% if form.non_field_errors %}shake{% endif %}">
            
            <!-- Logo & Header -->
            <div class="text-center mb-4">
                <div class="icon-circle bg-primary text-white mx-auto mb-3">
                    <i class="fas fa-user-plus fa-2x"></i>
                </div>
                <h3 class="fw-bold text-dark">Create PhiShield Account</h3>
                <p class="text-muted">Join us in fighting phishing attacks</p>
            </div>
            
            <!-- Error (non-field) -->
            {% if form.non_field_errors %}
                <div class="alert alert-danger fade-in small">
                    {{ form.non_field_errors }}
                </div>
            {% endif %}
            
            <!-- Registration Form -->
            <form method="post" novalidate>
                {% csrf_token %}
                
                <!-- Username -->
                <div class="mb-3">
                    <label for="{{ form.username.id_for_label }}" class="form-label fw-semibold">
                        <i class="fas fa-user"></i> Username
                    </label>
                    {{ form.username }}
                    {% if form.username.errors %}
                        <div class="text-danger mt-1 small">{{ form.username.errors }}</div>
                    {% endif %}
                </div>
                
                <!-- Email -->
                <div class="mb-3">
                    <label for="{{ form.email.id_for_label }}" class="form-label fw-semibold">
                        <i class="fas fa-envelope"></i> Email
                    </label>
                    {{ form.email }}
                    {% if form.email.errors %}
                        <div class="text-danger mt-1 small">{{ form.email.errors }}</div>
                    {% endif %}
                    <div class="form-text small">
                        <i class="fas fa-info-circle me-1"></i>We'll send a verification link to this email
                    </div>
                </div>
                
                <!-- First and Last Name -->
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.first_name.id_for_label }}" class="form-label fw-semibold">
                            <i class="fas fa-id-card"></i> First Name
                        </label>
                        {{ form.first_name }}
                        {% if form.first_name.errors %}
                            <div class="text-danger mt-1 small">{{ form.first_name.errors }}</div>
                        {% endif %}
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.last_name.id_for_label }}" class="form-label fw-semibold">
                            <i class="fas fa-id-card"></i> Last Name
                        </label>
                        {{ form.last_name }}
                        {% if form.last_name.errors %}
                            <div class="text-danger mt-1 small">{{ form.last_name.errors }}</div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Password -->
                <div class="mb-3">
                    <label for="{{ form.password1.id_for_label }}" class="form-label fw-semibold">
                        <i class="fas fa-lock"></i> Password
                    </label>
                    <div class="input-group">
                        {{ form.password1 }}
                        <button type="button" class="btn btn-outline-secondary rounded-end-3 toggle-btn" id="toggle-password-1" aria-label="Show/Hide Password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    {% if form.password1.errors %}
                        <div class="text-danger mt-1 small">{{ form.password1.errors }}</div>
                    {% endif %}
                    <div class="form-text small">
                        <i class="fas fa-key me-1"></i>Must contain at least 8 characters with letters and numbers
                    </div>
                </div>
                
                <!-- Confirm Password -->
                <div class="mb-3">
                    <label for="{{ form.password2.id_for_label }}" class="form-label fw-semibold">
                        <i class="fas fa-lock"></i> Confirm Password
                    </label>
                    <div class="input-group">
                        {{ form.password2 }}
                        <button type="button" class="btn btn-outline-secondary rounded-end-3 toggle-btn" id="toggle-password-2" aria-label="Show/Hide Password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    {% if form.password2.errors %}
                        <div class="text-danger mt-1 small">{{ form.password2.errors }}</div>
                    {% endif %}
                </div>
                
                <!-- Terms Agreement Checkbox -->
                <div class="mb-3 p-3 bg-light rounded-3 border terms-box">
                    <div class="form-check">
                        {{ form.agree_to_terms }}
                        <label class="form-check-label" for="{{ form.agree_to_terms.id_for_label }}">
                            I agree to the <a href="#" class="text-primary fw-semibold hover-underline" data-bs-toggle="modal" data-bs-target="#termsModal">Terms and Conditions</a>
                        </label>
                    </div>
                    {% if form.agree_to_terms.errors %}
                        <div class="text-danger mt-2 small">{{ form.agree_to_terms.errors }}</div>
                    {% endif %}
                </div>
                
                <!-- Submit Button -->
                <button type="submit" class="btn btn-primary w-100 btn-lg rounded-3 shadow-sm btn-hover mt-3">
                    <i class="fas fa-user-check"></i> Create Account
                </button>
            </form>
            
            <!-- Divider -->
            <div class="d-flex align-items-center my-4">
                <hr class="flex-grow-1">
                <span class="mx-2 text-muted small">OR</span>
                <hr class="flex-grow-1">
            </div>
            
            <!-- Login Link -->
            <div class="text-center">
                <p class="text-muted mb-2">Already have an account?</p>
                <a href="{% url 'phishield:login' %}" class="btn btn-outline-primary rounded-3 px-4 shadow-sm btn-hover-outline">
                    <i class="fas fa-sign-in-alt"></i> Login Here
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Terms and Conditions Modal -->
<div class="modal fade" id="termsModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title">
                    <i class="fas fa-file-contract me-2"></i>
                    PhiShield Terms and Conditions
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <div class="alert alert-info border-0 shadow-sm">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Important:</strong> Please read these terms carefully before using PhiShield.
                </div>

                <h6 class="text-primary mt-4 mb-3">
                    <i class="fas fa-check-circle me-2"></i>1. Acceptance of Terms
                </h6>
                <p>By creating an account with PhiShield, you agree to be bound by these Terms and Conditions and our Privacy Policy.</p>

                <h6 class="text-primary mt-4 mb-3">
                    <i class="fas fa-cogs me-2"></i>2. Service Description
                </h6>
                <p>PhiShield is a phishing detection tool designed to:</p>
                <ul class="custom-list">
                    <li>Analyze URLs for potential phishing threats</li>
                    <li>Scan messages for suspicious content</li>
                    <li>Provide educational security information</li>
                    <li>Help users identify potential online threats</li>
                </ul>

                <h6 class="text-primary mt-4 mb-3">
                    <i class="fas fa-user-shield me-2"></i>3. User Responsibilities
                </h6>
                <p>You agree to:</p>
                <ul class="custom-list">
                    <li>Use PhiShield only for legitimate security purposes</li>
                    <li>Not attempt to bypass or compromise our security measures</li>
                    <li>Provide accurate information during registration</li>
                    <li>Maintain the confidentiality of your account credentials</li>
                    <li>Use the service in compliance with all applicable laws</li>
                </ul>

                <h6 class="text-primary mt-4 mb-3">
                    <i class="fas fa-ban me-2"></i>4. Prohibited Activities
                </h6>
                <p>You may not use PhiShield to:</p>
                <ul class="custom-list">
                    <li>Conduct any illegal or unauthorized activities</li>
                    <li>Harass, abuse, or harm others</li>
                    <li>Distribute malware or malicious content</li>
                    <li>Attempt to reverse engineer or hack the service</li>
                    <li>Use automated systems to access the service excessively</li>
                </ul>

                <h6 class="text-primary mt-4 mb-3">
                    <i class="fas fa-exclamation-triangle me-2"></i>5. Disclaimer
                </h6>
                <div class="alert alert-warning border-0 shadow-sm">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    <strong>Security Notice:</strong> PhiShield is designed as an educational and auxiliary tool for identifying potential phishing threats. It should not be your only security measure. We cannot guarantee 100% accuracy in threat detection, and users should exercise caution and use multiple security practices.
                </div>

                <h6 class="text-primary mt-4 mb-3">
                    <i class="fas fa-lock me-2"></i>6. Privacy and Data
                </h6>
                <p>We respect your privacy:</p>
                <ul class="custom-list">
                    <li>URLs and messages you check are stored securely</li>
                    <li>We do not share your personal data with third parties</li>
                    <li>You can delete your account and associated data at any time</li>
                    <li>We implement security measures to protect your information</li>
                </ul>

                <h6 class="text-primary mt-4 mb-3">
                    <i class="fas fa-key me-2"></i>7. Account Security
                </h6>
                <p>You are responsible for:</p>
                <ul class="custom-list">
                    <li>Maintaining the confidentiality of your password</li>
                    <li>All activities that occur under your account</li>
                    <li>Promptly notifying us of any security breaches</li>
                </ul>

                <h6 class="text-primary mt-4 mb-3">
                    <i class="fas fa-sync me-2"></i>8. Service Modifications
                </h6>
                <p>We reserve the right to:</p>
                <ul class="custom-list">
                    <li>Modify or discontinue the service at any time</li>
                    <li>Update these terms as needed</li>
                    <li>Limit usage to ensure service quality</li>
                </ul>

                <div class="alert alert-success border-0 shadow-sm mt-4">
                    <i class="fas fa-shield-alt me-2"></i>
                    <strong>Stay Safe Online:</strong> Remember that no single tool can replace good security habits. Always verify suspicious communications through multiple channels.
                </div>
            </div>
            <div class="modal-footer bg-light">
                <button type="button" class="btn btn-primary rounded-3 shadow-sm px-4 btn-hover" data-bs-dismiss="modal">
                    <i class="fas fa-check me-2"></i>I Understand
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Password Toggle Script -->
<script>
  // Get password fields - handle both input and password types
  const passwordField1 = document.querySelector('input[name="password1"]');
  const passwordField2 = document.querySelector('input[name="password2"]');
  
  if (passwordField1) {
    passwordField1.id = 'password-field-1';
    document.getElementById("toggle-password-1").addEventListener("click", function() {
      const icon = this.querySelector("i");
      if (passwordField1.type === "password") {
        passwordField1.type = "text";
        icon.classList.replace("fa-eye", "fa-eye-slash");
      } else {
        passwordField1.type = "password";
        icon.classList.replace("fa-eye-slash", "fa-eye");
      }
    });
  }

  if (passwordField2) {
    passwordField2.id = 'password-field-2';
    document.getElementById("toggle-password-2").addEventListener("click", function() {
      const icon = this.querySelector("i");
      if (passwordField2.type === "password") {
        passwordField2.type = "text";
        icon.classList.replace("fa-eye", "fa-eye-slash");
      } else {
        passwordField2.type = "password";
        icon.classList.replace("fa-eye-slash", "fa-eye");
      }
    });
  }
</script>

<!-- Animations & Styles -->
<style>
  /* Icon Circle */
  .icon-circle {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(13, 110, 253, 0.2);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .icon-circle:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(13, 110, 253, 0.3);
  }

  /* Content Card Enhancements */
  .content-card {
    background: linear-gradient(to bottom, #ffffff 0%, #f8f9fa 100%);
    border: 1px solid rgba(0, 0, 0, 0.08);
    transition: box-shadow 0.3s ease;
  }

  .content-card:hover {
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12) !important;
  }

  /* Input Focus Effects */
  .form-control:focus {
    border-color: #0d6efd;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.15);
    transform: translateY(-1px);
    transition: all 0.2s ease;
  }

  /* Input Group Fix for Password Fields */
  .input-group .form-control {
    border-top-right-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
    border-top-left-radius: 0.375rem !important;
    border-bottom-left-radius: 0.375rem !important;
  }

  /* Button Hover Effects */
  .btn-hover {
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .btn-hover::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    transform: translate(-50%, -50%);
    transition: width 0.6s ease, height 0.6s ease;
  }

  .btn-hover:hover::before {
    width: 300px;
    height: 300px;
  }

  .btn-hover:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(25, 135, 84, 0.3);
  }

  .btn-hover:active {
    transform: translateY(0);
  }

  /* Outline Button Hover */
  .btn-hover-outline {
    transition: all 0.3s ease;
  }

  .btn-hover-outline:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(13, 110, 253, 0.2);
    background-color: rgba(13, 110, 253, 0.05);
  }

  /* Toggle Button Enhancement */
  .toggle-btn {
    transition: all 0.2s ease;
    border-left: none;
  }

  .toggle-btn:hover {
    background-color: #e9ecef;
    transform: scale(1.05);
  }

  .toggle-btn:active {
    transform: scale(0.95);
  }

  /* Terms Box Enhancement */
  .terms-box {
    transition: all 0.3s ease;
  }

  .terms-box:hover {
    background-color: #e9ecef !important;
  }

  .form-check {
    display: flex;
    align-items: center;
  }

  .form-check-input {
    cursor: pointer;
    transition: all 0.2s ease;
    margin: 0;
    flex-shrink: 0;
  }

  .form-check-input:checked {
    background-color: #198754;
    border-color: #198754;
  }

  .form-check-label {
    cursor: pointer;
    margin-left: 0.5rem;
    margin-bottom: 0;
  }

  /* Shake Animation */
  @keyframes shake {
    0% { transform: translateX(0); }
    20% { transform: translateX(-8px); }
    40% { transform: translateX(8px); }
    60% { transform: translateX(-8px); }
    80% { transform: translateX(8px); }
    100% { transform: translateX(0); }
  }
  .shake { animation: shake 0.4s ease-in-out; }

  /* Fade-in Animation */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .fade-in { animation: fadeIn 0.5s ease forwards; }

  /* Fade-in for whole card */
  @keyframes fadeInCard {
    from { opacity: 0; transform: translateY(20px) scale(0.98); }
    to { opacity: 1; transform: translateY(0) scale(1); }
  }
  .fade-in-card { animation: fadeInCard 0.6s ease-out forwards; }

  /* Hover underline for links */
  .hover-underline {
    position: relative;
    transition: color 0.3s ease;
    text-decoration: none;
  }

  .hover-underline::after {
    content: '';
    position: absolute;
    width: 0;
    height: 2px;
    bottom: -2px;
    left: 0;
    background-color: #0d6efd;
    transition: width 0.3s ease;
  }

  .hover-underline:hover::after {
    width: 100%;
  }

  .hover-underline:hover {
    color: #0a58ca !important;
  }

  /* Alert Enhancement */
  .alert {
    border-left: 4px solid;
    border-radius: 0.5rem;
  }

  .alert-danger {
    border-left-color: #dc3545;
    background-color: #f8d7da;
  }

  /* Label Icons Animation */
  .form-label i {
    transition: transform 0.2s ease;
  }

  .form-label:hover i {
    transform: scale(1.1);
  }

  /* Divider Enhancement */
  hr {
    opacity: 0.15;
    border-color: #6c757d;
  }

  /* Smooth transitions for inputs */
  .form-control {
    transition: all 0.2s ease;
  }

  /* Modal Enhancements */
  .modal-content {
    border-radius: 1rem;
  }

  .modal-header {
    border-radius: 1rem 1rem 0 0;
  }

  /* Custom List Styling */
  .custom-list {
    list-style: none;
    padding-left: 0;
  }

  .custom-list li {
    padding-left: 1.5rem;
    position: relative;
    margin-bottom: 0.5rem;
  }

  .custom-list li::before {
    content: "âœ“";
    position: absolute;
    left: 0;
    color: #198754;
    font-weight: bold;
  }

  /* Form Text Enhancement */
  .form-text {
    color: #6c757d;
  }

  .form-text i {
    color: #198754;
  }
</style>
{% endblock %}